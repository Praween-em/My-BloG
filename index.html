<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Praveen's Portfolio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root{
    --bg:#1e1e1e; --panel:#252526; --sidebar:#252526; --active:#37373d;
    --text:#d4d4d4; --muted:#9aa0a6; --accent:#0e639c; --border:#2d2d2d;
    --tab:#2d2d2d; --tab-active:#1f2937; --badge:#2b88d8;
    --green:#4caf50; --red:#e57373; --yellow:#ffc107;
    --font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }
  [data-theme="light"]{
    --bg:#f5f7fb; --panel:#ffffff; --sidebar:#f0f2f8; --active:#e7eaf3;
    --text:#1f2328; --muted:#6b7280; --accent:#2563eb; --border:#dfe3ea;
    --tab:#e7eaf3; --tab-active:#ffffff; --badge:#2563eb;
  }
  *{box-sizing:border-box; margin:0; padding:0}
  html,body{height:100%; overflow:scroll;}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 var(--font)}
  
  /* Responsive layout */
  .layout{
    display:grid;
    grid-template-rows: 40px 1fr 26px;
    height:100vh;
    position: relative;
  }
  .sidebar{
    position: fixed;
    top: 40px;
    left: 0;
    bottom: 26px;
    width: 260px;
    background:var(--sidebar);
    border-right:1px solid var(--border);
    padding:8px;
    overflow:auto;
    z-index: 10;
    transform: translateX(-100%);
    transition: transform 0.2s ease;
  }
  .sidebar.visible{
    transform: translateX(0);
  }
  .content{
    display:flex;
    flex-direction:column;
    min-width:0;
    grid-row: 2;
    width:100%;

  }
  .topbar{
    grid-row:1;
    background:var(--panel);
    display:flex;
    align-items:center;
    gap:8px;
    padding:0 10px;
    border-bottom:1px solid var(--border);
    z-index:5;
    position:sticky;
    top:0;
  }
  .statusbar{
    grid-row:3;
    background:var(--panel);
    display:flex;
    align-items:center;
    gap:10px;
    padding:0 10px;
    border-top:1px solid var(--border);
    color:var(--muted);
    position:sticky;
    bottom:0;
  }
  
  /* Desktop layout */
  @media (min-width: 768px) {
    .layout{
      grid-template-columns: 260px 1fr;
    }
    .sidebar{
      position: static;
      transform: none;
      grid-column: 1;
      grid-row: 2;
    }
    .content{
      grid-column: 2;
    }
    .topbar{grid-column:1/-1}
    .statusbar{grid-column:1/-1}
  }

  /* Sidebar toggle button */
  .sidebar-toggle{
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    color: var(--text);
    padding: 4px;
    margin-right: 8px;
    cursor: pointer;
    width: 28px;
    height: 28px;
    border-radius: 4px;
  }
  .sidebar-toggle:hover{
    background: var(--active);
  }
  @media (min-width: 768px) {
    .sidebar-toggle{
      display: none;
    }
  }

  /* Responsive adjustments */
  .editor-inner{
    padding: 10px;
    max-width: 980px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
    overflow-y: auto;
    height: 100%;
  }
  .tabs{
    display: flex;
    gap: 2px;
    background: var(--panel);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
    white-space: nowrap;
  }
  /* Custom scrollbar for tabs */
  .tabs::-webkit-scrollbar {
    height: 3px;
  }
  .tabs::-webkit-scrollbar-thumb {
    background-color: var(--accent);
    border-radius: 3px;
  }
  .tab{
    display: flex;
    align-items: center;
    gap: 8px;
    max-width: 280px;
    min-width: 100px; /* Adjusted for smaller screens */
    padding: 6px 10px;
    background: var(--tab);
    border-right: 1px solid var(--border);
    cursor: pointer;
    color: var(--text);
    flex-shrink: 0; /* Prevent tabs from shrinking below min-width */
  }
  .tab.active{
    background: var(--tab-active);
    font-weight: 600;
  }
  .img-wrap{
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .img-wrap img{
    max-width: 100%;
    height: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    max-height: 800px;
    object-fit: contain;
    display: block;
  }

  /* Original styles */
  .brand{
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
  }
  .brand svg{
    width: 18px;
    height: 18px;
  }
  .spacer{
    flex: 1;
  }
  .btn{
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text);
    padding: 4px 8px;
    border-radius: 6px;
    cursor: pointer;
    white-space: nowrap;
  }
  .btn:hover{
    background: var(--active);
  }

  /* Theme Toggle Button Styles */
  #themeToggle {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .theme-icon-wrapper {
    display: flex;
    align-items: center;
  }
  /* Show sun icon to switch to light, moon to switch to dark */
  [data-theme="dark"] .sun-icon { display: block; }
  [data-theme="dark"] .moon-icon { display: none; }
  [data-theme="light"] .sun-icon { display: none; }
  [data-theme="light"] .moon-icon { display: block; }
  
  /* Responsive styles for the theme toggle button */
  @media (max-width: 767px) {
    .theme-text {
      display: none; /* Hide text on mobile */
    }
    #themeToggle {
      justify-content: center;
      width: 28px; /* Match sidebar toggle button size */
      height: 28px;
      padding: 4px;
    }
  }

  .section-title{
    font-size: 12px;
    color: var(--muted);
    margin: 6px 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .tree{
    user-select: none;
  }
  .node{
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 6px;
    border-radius: 6px;
    cursor: pointer;
  }
  .node:hover{
    background: var(--active);
  }
  .node.active{
    background: var(--active);
  }
  .node .name{
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .badge{
    font-size: 11px;
    background: var(--badge);
    color: #fff;
    border-radius: 10px;
    padding: 1px 6px;
  }
  .indent{
    padding-left: 16px;
  }
  .editor{
    position: relative;
    flex: 1;
    overflow: hidden;
    background: var(--bg);
  }
  pre, code{
    font: 13px/1.6 var(--font);
  }
  pre{
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px;
    overflow: auto;
    white-space: pre-wrap;
    word-break: break-all;
  }
  pre[contenteditable="true"]{
    outline: none;
  }
  .md {
    word-wrap: break-word;
  }
  .md h1, .md h2, .md h3{
    margin: 0.6em 0 0.2em;
  }
  .md h1{
    font-size: 22px;
  }
  .md h2{
    font-size: 18px;
  }
  .md h3{
    font-size: 16px;
  }
  .md p{
    margin: 0.4em 0;
  }
  .md ul{
    margin: 0.3em 0 0.6em 1.2em;
  }
  .md a{
    color: var(--accent);
    text-decoration: none;
  }
  .md a:hover{
    text-decoration: underline;
  }
  .status-dot{
    width: 8px;
    height: 8px;
    background: var(--green);
    border-radius: 50%;
  }
  .kbd{
    border: 1px solid var(--border);
    border-bottom-width: 2px;
    border-radius: 4px;
    padding: 0 4px;
    font-size: 12px;
  }
  .mono{
    font-family: var(--font);
  }
</style>
</head>
<body data-theme="dark">
<div class="layout">
  <div class="topbar">
    <button class="sidebar-toggle" id="sidebarToggleBtn">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
      </svg>
    </button>
    <div class="brand">
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M20 3 10 9 6 6 3 8l7 4-7 4 3 2 4-3 10 6V3Z" fill="currentColor" opacity=".8"/>
      </svg>
      <span>Portfolio</span>
    </div>
    <span class="mono" id="repoName"></span>
    <div class="spacer"></div>
    <button class="btn" id="themeToggle" title="Toggle theme">
      <span class="theme-icon-wrapper">
        <!-- Sun icon, visible in dark mode -->
        <svg class="sun-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>
        <!-- Moon icon, visible in light mode -->
        <svg class="moon-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.31 0-6-2.69-6-6 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
      </span>
      <span class="theme-text">Toggle Theme</span>
    </button>
 
  </div>

  <aside class="sidebar visible" id="sidebar">
    <div class="section-title">EXPLORER</div>
    <div id="tree" class="tree"></div>
  </aside>

  <main class="content">
    <div class="tabs" id="tabs"></div>
    <div class="editor"><div class="editor-inner" id="editor"></div></div>
  </main>

  <div class="statusbar">
    <span class="status-dot"></span>
    <span id="status">Ready</span>
    <div class="spacer"></div>
    <span class="kbd">Ctrl/Cmd + P</span> Quick Open
    <span class="kbd">Ctrl/Cmd + W</span> Close Tab
  </div>
</div>

<script>
/* ===========================
   Virtual File System (VFS)
   =========================== */
const VFS = {
  name: "praween-em",   // <-- set to your GitHub username to match repo
  type: "folder",
  children: [
    {
      name: "profile",
      type: "folder",
      children: [
        { 
          name: "about_me.md", 
          type: "file", 
          content: `# Hi, I'm Praveen kumar

I'm a developer focused on 
**Web Applications**, **Frontend designs**, and **Mobile AI**. 
I love building delightful UX with strong engineering under the hood.

- 🌍 Based in: Anantapur, Andhra Pradesh, IN
- 🧠 Interests: coding, physics, math, music, photography, AI , and more
- ✉️ Email: [praveen1345221@gmail.com](mailto:praveen1345221@gmail.com)
- 🔗 Links: [GitHub](https://github.com/praween-em) · [LinkedIn](https://www.linkedin.com/in/praveen-kumar-a00420280/) · [Website](https://praveenkumar.blog)

## What I do
- Design accessible, scalable frontends
- Build performant, user-friendly UIs
- Create tools that improve developer workflows
- Develop mobile apps with AI features
- Optimize performance and reliability
- Collaborate with cross-functional teams
- Stay up-to-date with industry trends and best practices
- Advocate for clean, maintainable code
- Mentor junior developers and contribute to open source
- Build high-signal backends with clean APIs
- Advocate for AI regulation and ethics
- Ship fast, instrumented, maintainable code

## Currently
- ⚙️ Prototyping a VS Code–style portfolio (this!)
- 📚 Reading: *Clean Architecture*`
        },
        { 
          name: "education.json", 
          type: "file", 
          content: `[
  {
    "PG degree": "Master of Computer Applications",
    "institution": "JNTU Anantapur",
    "year": "2022–2024",
    "highlights": ["GPA 8.1/10", "Computer Science Engineering specialization"],
  },
  {
    "UG degree": "Bsc in Mathematics, Physics, and Chemistry",
    "institution": "SSBN Degree College",
    "year": "2017–2020",
    "highlights": ["GPA 7.8/10.0 ", "Specialized in Mathematics and Physics (Instrumentation)"],
  }
    {
  "Class": "Intermediate Education",
    "institution": "Govt Juniour College",
    "year": "2015–2017",
    "highlights": ["GPA 883/1000 ", "Mathematics, Physics, and Chemistry (MPC) stream"],
  }
]`
        },
        { 
          name: "experience.txt", 
          type: "file", 
          content: `Experience
----------

Founder & CEO, [Toletu](https://toletu.com)
• Built an AI roommate matching app with 1000+ users.
• Developed a web scraper for real-time data collection.
• Built an interface for users to post and browse listings.
• Implemented a recommendation engine using ML.
• Designed a user-friendly UI with React and Tailwind CSS.
• Deployed on Vercel with Postgres backend.
• Integrated Stripe for payments and subscriptions.
• Optimized performance with caching and lazy loading.
• Managed a small team of 3 developers.

Founder Praisol Web Solutions
• Developed  websites and web apps for local businesses.
• Built a portfolio website for a local Production Company (N Square films).
• developed educational content for online platforms (Trikona educational services).

Freelance — Full Stack Developer (2020–present)
• Built 10+ web apps using React, Node.js, and MongoDB.
• Developed REST APIs and integrated third-party services.
• Designed responsive UIs with HTML, CSS, and JavaScript.
• Implemented CI/CD pipelines with GitHub Actions.
• Deployed apps on AWS, Heroku, and Vercel.
• Mentored junior developers and conducted code reviews.
• Contributed to open source projects on GitHub.
• Participated in hackathons and coding competitions.
• Published articles on web development and AI on Medium.

•Subject Matter Expert, [MAD EDUCATORS](2020-2022)
• Developed Math content for BSc students.
• Created interactive quizzes and exercises.
• Conducted online classes and doubt-clearing sessions.
• Collaborated with a team of educators to improve curriculum.
`
        },
        { 
          name: "contact.html", 
          type: "file", 
          content: `<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body {
      font: 14px system-ui;
      margin: 20px;
      color: #111;
    }
    a {
      color: #2563eb;
    }
      button {
      background: #2563eb;
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #1d4ed8;
    }
  </style>
</head>
<body>
  <h2>Contact</h2>
  <p>Say hi at <a href="mailto:praveen1345221@gmail.com">Send a mail </a> or DM on <a href="https://linkedin.com/in/Praween-em" target="" rel="opener">LinkedIn</a>.</p>
  <form onsubmit="alert('Pretend sent!'); return false;">
    <label>Name<br><input required></label><br><br>
    <label>Email<br><input type="email" required></label><br><br>
    <label>Message<br><textarea rows="5" required></textarea></label><br><br>
    <button>Send</button>
  </form>
 
  <div>

      <li><a href="https://github.com/praween-em" target="_blank" rel="noopener">GitHub</a></li>
  </div>

  </body>
</html>`
        }
      ]
    },
    {
      name: "projects",
      type: "folder",
      children: [
        { 
          name: "projects.js", 
          type: "file", 
          content: `// Selected projects
export const projects = [
  {
    name: "Toletu — Rental listings & Roommate Pool",
    stack: ["TypeScript", "React", "Vite", "Supabase"],
    blurb: "A roommate matching app with ML-based compatibility score.",
    link: "https://toletu.com",
    links: { 
      repo: "https://github.com/praween-em/toletu", 
      demo: "#" 
    }
        },
      {
    name: "Praisol Web Solutions",
    stack: ["HTML", "CSS", "JavaScript"],
    blurb: "A portfolio website for a local production company.",
    links: { 
      repo: " https://github.com/praween-em/praisol/",
      demo: "#"
      }
        },
  {
    name: "Iss Intelligent Surveillance System",
    stack: ["Python", "OpenCV", "Flask", "TensorFlow"],
    tech: ["Object Detection", "Face Recognition", "Real-time Monitoring"],
    blurb: "A smart surveillance system using computer vision.",
    links: { 
      repo: "https://github.com/praween-em/Intelligent-Surveillance-System", 
      demo: "#" 
    }
  }
];`
        },
        { 
          name: "project1.png", 
          type: "file", 
          content: "179773cf-518a-4871-9534-c98b7510c37a.png" 
        },
        { 
          name: "project2.png", 
          type: "file", 
          content: "a3b18e18-80af-407d-bef4-071b09a09704.png" 
        },
        { 
          name: "project3.png", 
          type: "file", 
          content: "ChatGPT Image Aug 17, 2025, 01_16_59 AM.png" 
        }

      ]
    },
    {
      name: "gallery",
      type: "folder",
      children: [
        { 
          name: "profile.jpg", 
          type: "file", 
          content: "praveen kumar.png" 
        },
        { 
          name: "team.jpg", 
          type: "file", 
          content: "https://via.placeholder.com/800x500.png?text=Team+Image" 
        }
      ]
    },
    {
      name: "README.md",
      type: "file",
      content: `# VS Code Portfolio

This portfolio is designed to look like the VS Code editor.

- Click files in the sidebar to open them as tabs.
- Markdown, JSON/TXT/JS, images, and HTML are supported.
- Text files are *editable* in the browser (changes are not saved).

## Features
- Dark/light theme toggle
- Responsive design for all screen sizes
- File explorer with collapsible folders
- Tabbed interface for multiple files
- Real-time markdown rendering`
    }
  ]
};



/* ==============
   UI Rendering
   ============== */
const $tree = document.getElementById('tree');
const $tabs = document.getElementById('tabs');
const $editor = document.getElementById('editor');
const $status = document.getElementById('status');
const $repoName = document.getElementById('repoName');
const $sidebar = document.getElementById('sidebar');
const $sidebarToggleBtn = document.getElementById('sidebarToggleBtn');

// Toggle sidebar visibility
$sidebarToggleBtn.addEventListener('click', () => {
  $sidebar.classList.toggle('visible');
});

// Close sidebar when clicking on a file (mobile)
function handleFileClick(path) {
  if (window.innerWidth < 768) {
    $sidebar.classList.remove('visible');
  }
  openFile(path);
}

$repoName.textContent = ' / ' + VFS.name;

const openTabs = []; // {path, name, type, content}
let activePath = null;

function iconFor(node){
  if(node.type === 'folder'){
    return '<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M10 4l2 2h8v12H4V4h6z"/></svg>';
  }
  const ext = node.name.split('.').pop().toLowerCase();
  const color = {
    md:'#43a047', json:'#f59e0b', js:'#f7df1e', txt:'#9aa0a6',
    html:'#e34f26', png:'#00bcd4', jpg:'#00bcd4', jpeg:'#00bcd4', gif:'#00bcd4', svg:'#00bcd4'
  }[ext] || '#9aa0a6';
  return `<svg width="14" height="14" viewBox="0 0 24 24" fill="${color}" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg>`;
}

function buildTree(node, basePath=''){
  const path = basePath ? basePath + '/' + node.name : node.name;
  if(node.type === 'folder'){
    const el = document.createElement('div');
    el.innerHTML = `
      <div class="node" data-path="${path}" data-type="folder">
        ${iconFor(node)} <span class="name">${node.name}</span> <span class="badge">${node.children.length}</span>
      </div>`;
    const childrenWrap = document.createElement('div');
    childrenWrap.className = 'indent';
    node.children.forEach(child => childrenWrap.appendChild(buildTree(child, path)));
    el.appendChild(childrenWrap);
    el.querySelector('.node').addEventListener('click', (e)=>{
      e.stopPropagation();
      childrenWrap.style.display = (childrenWrap.style.display === 'none') ? '' : 'none';
      setActiveNode(path);
    });
    return el;
  }else{
    const el = document.createElement('div');
    el.innerHTML = `
      <div class="node" data-path="${path}" data-type="file">
        ${iconFor(node)} <span class="name">${node.name}</span>
      </div>`;
    el.querySelector('.node').addEventListener('click', (e)=>{
      e.stopPropagation();
      handleFileClick(path);
    });
    return el;
  }
}

function setActiveNode(path){
  $tree.querySelectorAll('.node').forEach(n => n.classList.toggle('active', n.dataset.path === path));
}

$tree.appendChild(buildTree(VFS));

/* ===========
   Tabs logic
   =========== */
function openFile(path){
  try {
    const node = findNodeByPath(VFS, path);
    if(!node || node.type !== 'file') return;
    
    if(!openTabs.find(t => t.path === path)){
      openTabs.push({ path, name: node.name, type: 'file', content: node.content });
      renderTabs();
    }
    setActiveTab(path);
    renderEditor(node);
    $status.textContent = 'Opened ' + path;
  } catch (e) {
    console.error("Error opening file:", e);
    $status.textContent = 'Error opening file';
  }
}

function closeTab(path){
  const idx = openTabs.findIndex(t => t.path === path);
  if(idx !== -1){
    openTabs.splice(idx,1);
    if(activePath === path){
      activePath = openTabs.length ? openTabs[openTabs.length-1].path : null;
      if(activePath){
        const node = findNodeByPath(VFS, activePath);
        renderEditor(node);
      }else{
        $editor.innerHTML = '<div class="md"><p>No files open</p></div>';
      }
    }
    renderTabs();
  }
}

function setActiveTab(path){
  activePath = path;
  renderTabs();
}

function renderTabs(){
  $tabs.innerHTML = '';
  openTabs.forEach(tab=>{
    const el = document.createElement('div');
    el.className = 'tab' + (tab.path === activePath ? ' active':'');
    el.innerHTML = `<span class="name">${tab.name}</span><span class="close">×</span>`;
    el.addEventListener('click', ()=>{ 
      setActiveTab(tab.path); 
      renderEditor(findNodeByPath(VFS, tab.path)); 
    });
    el.querySelector('.close').addEventListener('click', (e)=>{ 
      e.stopPropagation(); 
      closeTab(tab.path); 
    });
    $tabs.appendChild(el);
  });
}

/* ==============
   Editor render
   ============== */
function renderEditor(node){
  if (!node) return;
  
  const ext = node.name.split('.').pop().toLowerCase();
  $editor.innerHTML = '';
  
  if(['png','jpg','jpeg','gif','svg'].includes(ext)){
    const img = document.createElement('img');
    img.src = node.content;
    img.alt = node.name;
    const wrap = document.createElement('div');
    wrap.className = 'img-wrap';
    wrap.appendChild(img);
    $editor.appendChild(wrap);
    return;
  }
  
  if(ext === 'md'){
    const html = renderMarkdown(node.content);
    const div = document.createElement('div');
    div.className = 'md';
    div.innerHTML = html;
    $editor.appendChild(div);
    return;
  }
  
  if(ext === 'html'){
    // sandboxed preview
    const iframe = document.createElement('iframe');
    iframe.setAttribute('sandbox','allow-forms allow-scripts allow-same-origin');
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.srcdoc = node.content;
    $editor.appendChild(iframe);
    return;
  }
  
  // json/txt/js → editable
  const pre = document.createElement('pre');
  pre.setAttribute('contenteditable','true');
  pre.textContent = node.content;
  $editor.appendChild(pre);
}

/* =========
   Helpers
   ========= */
function findNodeByPath(node, path, base=''){
  const here = base ? base + '/' + node.name : node.name;
  if(here === path) return node;
  if(node.type === 'folder' && node.children){
    for(const ch of node.children){
      const found = findNodeByPath(ch, path, here);
      if(found) return found;
    }
  }
  return null;
}

// Simple markdown renderer
function renderMarkdown(md){
  let html = md
    .replace(/&/g,'&amp;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;');
  
  // Images
  html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, (_, alt, src) => {
    return `<img alt="${alt}" src="${src}" style="max-width:100%; border:1px solid var(--border); border-radius:6px; margin:10px 0;">`;
  });
  
  // Links
  html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
  
  // Bold
  html = html.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
  
  // Italics
  html = html.replace(/\*([^*\n]+)\*/g, '<em>$1</em>');
  
  // Headings
  html = html.replace(/^### (.*)$/gm, '<h3>$1</h3>');
  html = html.replace(/^## (.*)$/gm, '<h2>$1</h2>');
  html = html.replace(/^# (.*)$/gm, '<h1>$1</h1>');
  
  // Lists
  html = html.replace(/^\s*-\s+(.*)$/gm, '<li>$1</li>');
  html = html.replace(/(<li>.*<\/li>)(?!\s*<li>)/gs, '<ul>$1</ul>');
  
  // Paragraphs
  html = html.replace(/(^|\n)([^<\n][^\n]*)/g, (m, p1, p2) => {
    if(/^<\/?(h1|h2|h3|ul|li)/.test(p2.trim())) return m;
    if(!p2.trim()) return m;
    return `${p1}<p>${p2}</p>`;
  });
  
  return html;
}

/* =========
   Commands
   ========= */
document.getElementById('themeToggle').addEventListener('click', ()=>{
  const cur = document.body.getAttribute('data-theme');
  const newTheme = cur === 'dark' ? 'light' : 'dark';
  document.body.setAttribute('data-theme', newTheme);
  $status.textContent = `Switched to ${newTheme} theme`;
});

/* Keyboard shortcuts */
document.addEventListener('keydown', (e)=>{
  const mod = e.ctrlKey || e.metaKey;
  
  if(mod && e.key.toLowerCase() === 'p'){
    e.preventDefault();
    $status.textContent = 'Quick Open: type a filename…';
    const name = prompt('Open file (type part of name):','about');
    if(!name) return;
    
    const matches = [];
    walk(VFS, (node, path) => {
      if(node.type === 'file' && node.name.toLowerCase().includes(name.toLowerCase())){
        matches.push(path);
      }
    });
    
    if(matches[0]) {
      openFile(matches[0]);
    } else {
      alert('No matching files found');
      $status.textContent = 'No matches found';
    }
  }
  
  if(mod && e.key.toLowerCase() === 'w'){
    e.preventDefault();
    if(activePath) {
      closeTab(activePath);
      $status.textContent = 'Closed tab';
    }
  }
});

function walk(node, fn, base=''){
  const path = base ? base + '/' + node.name : node.name;
  fn(node, path);
  if(node.type === 'folder' && node.children) {
    node.children.forEach(ch => walk(ch, fn, path));
  }
}

/* Initialize */
openFile(`${VFS.name}/README.md`);

// Auto-hide sidebar on mobile on load
if (window.innerWidth < 768) {
  $sidebar.classList.remove('visible');
}
</script>
</body>
</html>